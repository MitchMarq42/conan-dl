#!/bin/sh

# Declare{
startingdir="$PWD"
tmpdir="${TMPDIR:-/tmp}"
refresh="0.5"
watch="no"
menu="fzf"#}

# Define
## All functions which use variables must declare all of them as arguments.
## All functions which (re)assign must be in form `get_$var` and give that var on stdout.
is_integer () {
    case "${1#[+-]}" in
        (*[!0123456789]*) return 1 ;;
        ('')              return 1 ;;
        (*)               return 0 ;;
    esac
}
menu () {
    $menu
}
get_anime () {
    # USAGE: search_anime "$search" where $search is the approx anime name
    search=$1
    curl -s "https://$streamsite//search.html" \
        -G \
        -d "keyword=$search" |
    sed -n -E 's_^[[:space:]]*<a href="/category/([^"]*)" title="([^"]*)".*_\1_p' |
    menu
    # get_animegg is no longer necessary. This does it all and
    # spits out correctly formatted anime.
}
get_embedurl() {
    # USAGE: 
    animegg=$1
    epnum=$2
    curl -s "https://$streamsite/$animegg-episode-$epnum" |
    sed -n -E '
        /^[[:space:]]*<a href="#" rel="100"/{
        s/.*data-video="([^"]*)".*/https:\1/p
        q
        }'
}

# Process

# Print
